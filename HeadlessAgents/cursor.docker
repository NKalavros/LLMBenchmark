FROM debian:bookworm-slim

# Install minimal dependencies
ENV DEBIAN_FRONTEND=noninteractive

# Use HTTPS mirrors to avoid environments that block plain HTTP (Debian slim uses deb822 sources)
RUN if [ -f /etc/apt/sources.list.d/debian.sources ]; then \
			sed -i 's|http://|https://|g' /etc/apt/sources.list.d/debian.sources; \
		fi \
 && printf 'Acquire::https::Verify-Peer "false";\nAcquire::https::Verify-Host "false";\n' > /etc/apt/apt.conf.d/99insecure \
 && apt-get update \
 && apt-get install -y --no-install-recommends ca-certificates curl bash \
 && rm -f /etc/apt/apt.conf.d/99insecure \
 && update-ca-certificates \
 && rm -rf /var/lib/apt/lists/*

# Install Cursor CLI (places binaries under ~/.local)
RUN curl https://cursor.com/install -fsS | bash

# Ensure the CLI is on PATH
ENV PATH="/root/.local/bin:${PATH}"

# Default entrypoint runs the agent; pass flags like --version at runtime
ENTRYPOINT ["cursor-agent"]